<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>ConfiguraciÃ³n - ALEX 3.0</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="dashboard-body">

  <div class="sidebar">
    <h2 class="logo">ALEX 3.0</h2>
    <ul class="menu">
      <li><a href="dashboard.html">ğŸ  Inicio</a></li>
      <li><a href="inventario.html">ğŸ“¦ Inventario</a></li>
      <li><a href="ventas.html">ğŸ’µ Ventas</a></li>
      <li><a href="caja.html">ğŸ’° Caja</a></li>
      <li><a href="usuarios.html">ğŸ‘¤ Usuarios</a></li>
      <li><a href="reportes.html">ğŸ“Š Reportes</a></li>
      <li class="active"><a href="configuracion.html">âš™ï¸ ConfiguraciÃ³n</a></li>
    </ul>
  </div>

  <div class="main-content">
    <h1>âš™ï¸ ConfiguraciÃ³n de ALEX 3.0</h1>
    <p>Administra las opciones generales del sistema.</p>

    <!-- ğŸ”µ MONEDA DEL SISTEMA -->
    <div class="settings-box">
      <h2>ğŸ’µ Moneda del sistema</h2>
      <label for="monedaSistema">Moneda principal:</label>
      <select id="monedaSistema" onchange="guardarMonedaSistema()">
        <option value="GTQ">GTQ â€“ Quetzal (Guatemala)</option>
        <option value="MXN">MXN â€“ Peso mexicano</option>
        <option value="USD">USD â€“ DÃ³lar estadounidense</option>
        <option value="COP">COP â€“ Peso colombiano</option>
        <option value="PEN">PEN â€“ Sol peruano</option>
        <option value="CLP">CLP â€“ Peso chileno</option>
        <option value="BRL">BRL â€“ Real brasileÃ±o</option>
        <option value="ARS">ARS â€“ Peso argentino</option>
      </select>
      <p id="monedaSistemaInfo" style="margin-top:6px;"></p>
    </div>

    <!-- ğŸ”¥ MODO DESARROLLADOR -->
    <div class="settings-box">
      <h2>ğŸ› ï¸ Modo desarrollador</h2>
      <p>Desactiva cachÃ© y fuerza recarga instantÃ¡nea al actualizar archivos.</p>

      <label for="modoDevSwitch">Activar modo desarrollador:</label>
      <select id="modoDevSwitch" onchange="guardarModoDev()">
        <option value="0">Desactivado</option>
        <option value="1">Activado</option>
      </select>

      <p id="infoModoDev" style="margin-top:6px; font-size:0.9rem;"></p>
    </div>

    <!-- RESPALDOS -->
    <div class="settings-box">
      <h2>ğŸ—‚ï¸ Respaldos</h2>
      <button onclick="exportarRespaldoALEX3()">ğŸ’¾ Exportar respaldo</button>
      <button onclick="document.getElementById('archivoRespaldo').click()">ğŸ“‚ Importar respaldo</button>
      <input type="file" id="archivoRespaldo" accept="application/json" style="display:none" onchange="importarRespaldoALEX3(this.files[0])">
    </div>

    <!-- REINICIO -->
    <div class="settings-box">
      <h2>âš ï¸ Restaurar sistema</h2>
      <button onclick="restaurarFabrica()">ğŸ”„ Restaurar ALEX 3.0</button>
    </div>

  </div>

  <script src="alex-storage.js"></script>
  <script src="alex-dev.js"></script>

  <script>
    // =======================
    // MONEDA
    // =======================
    const MONEDAS_SISTEMA = {
      GTQ: { simbolo: "Q", nombre: "Quetzal" },
      MXN: { simbolo: "$", nombre: "Peso mexicano" },
      USD: { simbolo: "$", nombre: "DÃ³lar" },
      COP: { simbolo: "$", nombre: "Peso colombiano" },
      PEN: { simbolo: "S/", nombre: "Sol peruano" },
      CLP: { simbolo: "$", nombre: "Peso chileno" },
      BRL: { simbolo: "R$", nombre: "Real brasileÃ±o" },
      ARS: { simbolo: "$", nombre: "Peso argentino" }
    };

    function cargarMonedaSistema() {
      const sel = document.getElementById("monedaSistema");
      let codigo = localStorage.getItem("alex3_moneda_sistema") || "GTQ";
      sel.value = codigo;

      const m = MONEDAS_SISTEMA[codigo];
      document.getElementById("monedaSistemaInfo").innerText =
        "Moneda actual: " + m.simbolo + " (" + m.nombre + ")";
    }

    function guardarMonedaSistema() {
      const val = document.getElementById("monedaSistema").value;
      localStorage.setItem("alex3_moneda_sistema", val);
      alert("Moneda del sistema actualizada.");
      cargarMonedaSistema();
    }

    // =======================
    // MODO DESARROLLADOR
    // =======================
    function cargarModoDev() {
      const estado = localStorage.getItem("alex3_modo_dev") || "0";
      document.getElementById("modoDevSwitch").value = estado;

      document.getElementById("infoModoDev").innerText =
        estado === "1"
          ? "Modo desarrollador ACTIVADO. La cachÃ© estÃ¡ deshabilitada."
          : "Modo desarrollador desactivado.";
    }

    function guardarModoDev() {
      const val = document.getElementById("modoDevSwitch").value;
      localStorage.setItem("alex3_modo_dev", val);
      alert("Modo desarrollador actualizado. Recarga la pÃ¡gina.");
      location.reload();
    }

    // =======================
    // RESPALDOS / RESET
    // =======================
    function exportarRespaldoALEX3() {
      const data = {};
      Object.keys(localStorage).forEach(k => data[k] = localStorage.getItem(k));
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "alex3-respaldo.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function importarRespaldoALEX3(file) {
      const reader = new FileReader();
      reader.onload = (evt) => {
        const data = JSON.parse(evt.target.result);
        localStorage.clear();
        Object.keys(data).forEach(k => localStorage.setItem(k, data[k]));
        alert("Respaldo importado. Recarga la pÃ¡gina.");
        location.reload();
      };
      reader.readAsText(file);
    }

    function restaurarFabrica() {
      if (confirm("Â¿Seguro? Esto borra todo.")) {
        localStorage.clear();
        alert("Sistema restaurado.");
        location.reload();
      }
    }

    // =======================
    // INICIAR
    // =======================
    cargarMonedaSistema();
    cargarModoDev();
  </script>

</body>
</html>
