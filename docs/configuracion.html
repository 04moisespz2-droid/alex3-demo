<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ConfiguraciÃ³n - ALEX 3.0</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body class="dashboard-body">

  <div class="sidebar">
    <h2 class="logo">ALEX 3.0</h2>
    <ul class="menu">
      <li id="menu-dashboard"><a href="dashboard.html">ğŸ  Inicio</a></li>
      <li id="menu-inventario"><a href="inventario.html">ğŸ“¦ Inventario</a></li>
      <li id="menu-ventas"><a href="ventas.html">ğŸ’µ Ventas</a></li>
      <li id="menu-caja"><a href="caja.html">ğŸ’° Caja</a></li>
      <li id="menu-usuarios"><a href="usuarios.html">ğŸ‘¤ Usuarios</a></li>
      <li id="menu-reportes"><a href="reportes.html">ğŸ“Š Reportes</a></li>
      <li id="menu-configuracion"><a href="configuracion.html">âš™ï¸ ConfiguraciÃ³n</a></li>
    </ul>
  </div>

  <div class="main-content">
    <h1>ConfiguraciÃ³n de ALEX 3.0</h1>

    <div class="config-card">
      <h3>Moneda principal del sistema</h3>
      <p>Esta moneda se usarÃ¡ para mostrar precios, ventas, caja, etc.</p>

      <label for="monedaSelect">Selecciona la moneda:</label>
      <select id="monedaSelect" class="input">
        <option value="GTQ">ğŸ‡¬ğŸ‡¹ Quetzal guatemalteco (GTQ)</option>
        <option value="MXN">ğŸ‡²ğŸ‡½ Peso mexicano (MXN)</option>
        <option value="USD">ğŸ‡ºğŸ‡¸ DÃ³lar estadounidense (USD)</option>
        <option value="COP">ğŸ‡¨ğŸ‡´ Peso colombiano (COP)</option>
        <option value="PEN">ğŸ‡µğŸ‡ª Sol peruano (PEN)</option>
        <option value="CLP">ğŸ‡¨ğŸ‡± Peso chileno (CLP)</option>
        <option value="BRL">ğŸ‡§ğŸ‡· Real brasileÃ±o (BRL)</option>
        <option value="ARS">ğŸ‡¦ğŸ‡· Peso argentino (ARS)</option>
        <option value="EUR">ğŸ‡ªğŸ‡º Euro (EUR)</option>
      </select>

      <p style="margin-top:8px;">
        Vista previa: <strong id="previewMoneda">Q 123.45</strong>
      </p>
    </div>

    <div class="config-card">
      <h3>Modo desarrollador</h3>
      <p>Solo para ti / pruebas. Puede mostrar datos de ejemplo o atajos de pruebas.</p>

      <label>
        <input type="checkbox" id="modoDevCheck">
        Activar modo desarrollador
      </label>
    </div>

    <button class="btn" onclick="guardarConfiguracion()">Guardar configuraciÃ³n</button>
  </div>

  <script src="alex-storage.js"></script>
  <script src="alex-dev.js"></script>
  <script src="alex-roles.js"></script>

  <script>
    const usuarioActual = getUsuarioActualObligatorio();
    aplicarPermisosYProteger("configuracion");

    const MONEDAS = [
      { codigo: "GTQ", simbolo: "Q", ejemplo: "Q 123.45" },
      { codigo: "MXN", simbolo: "$", ejemplo: "$ 123.45 MXN" },
      { codigo: "USD", simbolo: "$", ejemplo: "$ 123.45" },
      { codigo: "COP", simbolo: "$", ejemplo: "$ 123.45 COP" },
      { codigo: "PEN", simbolo: "S/", ejemplo: "S/ 123.45" },
      { codigo: "CLP", simbolo: "$", ejemplo: "$ 123.45 CLP" },
      { codigo: "BRL", simbolo: "R$", ejemplo: "R$ 123.45" },
      { codigo: "ARS", simbolo: "$", ejemplo: "$ 123.45 ARS" },
      { codigo: "EUR", simbolo: "â‚¬", ejemplo: "â‚¬ 123.45" },
    ];

    function cargarConfiguracion() {
      let config = {};
      try {
        config = JSON.parse(localStorage.getItem("alex3_config") || "{}");
      } catch (e) {
        config = {};
      }

      const select = document.getElementById("monedaSelect");
      const checkDev = document.getElementById("modoDevCheck");

      if (config.monedaCodigo) {
        select.value = config.monedaCodigo;
      }

      if (typeof config.modoDesarrollador === "boolean") {
        checkDev.checked = config.modoDesarrollador;
      }

      actualizarPreview();
    }

    function actualizarPreview() {
      const codigo = document.getElementById("monedaSelect").value;
      const moneda = MONEDAS.find(m => m.codigo === codigo) || MONEDAS[0];
      document.getElementById("previewMoneda").innerText = moneda.ejemplo;
    }

    document.getElementById("monedaSelect").addEventListener("change", actualizarPreview);

    function guardarConfiguracion() {
      const codigo = document.getElementById("monedaSelect").value;
      const modoDev = document.getElementById("modoDevCheck").checked;

      const moneda = MONEDAS.find(m => m.codigo === codigo) || MONEDAS[0];

      const config = {
        monedaCodigo: moneda.codigo,
        monedaSimbolo: moneda.simbolo,
        modoDesarrollador: modoDev
      };

      localStorage.setItem("alex3_config", JSON.stringify(config));

      alert("ConfiguraciÃ³n guardada. Recarga las pÃ¡ginas para aplicar los cambios.");
    }

    // Inicializar
    cargarConfiguracion();
  </script>

</body>
</html>
